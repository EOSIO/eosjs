{"componentChunkName":"component---src-page-templates-content-page-jsx","path":"/v21.0/guides/native-tester","result":{"data":{"site":{"pathPrefix":"/auto-eosio-cdt"},"allMarkdownRemark":{"nodes":[{"fields":{"slug":"/latest/index"}},{"fields":{"slug":"/v1.4/index"}},{"fields":{"slug":"/v1.6/index"}},{"fields":{"slug":"/v2.0/index"}},{"fields":{"slug":"/v20.0/index"}},{"fields":{"slug":"/v1.5/index"}},{"fields":{"slug":"/v21.0/index"}},{"fields":{"slug":"/v20.1/index"}},{"fields":{"slug":"/latest/guides/first-smart-contract"}},{"fields":{"slug":"/latest/guides/native-tester"}},{"fields":{"slug":"/latest/guides/cmake"}},{"fields":{"slug":"/latest/tools/eosio-abidiff"}},{"fields":{"slug":"/latest/guides/generator-attributes"}},{"fields":{"slug":"/latest/tools/eosio-ld"}},{"fields":{"slug":"/latest/tools/eosio-init"}},{"fields":{"slug":"/latest/tools/eosio-abigen"}},{"fields":{"slug":"/v1.4/guides/cmake"}},{"fields":{"slug":"/latest/tools/eosio-cpp"}},{"fields":{"slug":"/v1.4/guides/first-smart-contract"}},{"fields":{"slug":"/v1.4/guides/generator-attributes"}},{"fields":{"slug":"/v1.4/tools/eosio-abidiff"}},{"fields":{"slug":"/latest/upgrading/1.5-to-1.6"}},{"fields":{"slug":"/v1.4/tools/eosio-abigen"}},{"fields":{"slug":"/v1.4/guides/native-tester"}},{"fields":{"slug":"/v1.4/tools/eosio-init"}},{"fields":{"slug":"/v1.4/tools/eosio-cpp"}},{"fields":{"slug":"/v1.4/tools/eosio-ld"}},{"fields":{"slug":"/latest/upgrading/1.2-to-1.3"}},{"fields":{"slug":"/v1.5/guides/cmake"}},{"fields":{"slug":"/v1.4/upgrading/1.5-to-1.6"}},{"fields":{"slug":"/v1.5/guides/first-smart-contract"}},{"fields":{"slug":"/v1.5/guides/generator-attributes"}},{"fields":{"slug":"/v1.4/upgrading/1.2-to-1.3"}},{"fields":{"slug":"/v1.5/guides/native-tester"}},{"fields":{"slug":"/v1.5/tools/eosio-abigen"}},{"fields":{"slug":"/v1.5/tools/eosio-init"}},{"fields":{"slug":"/v1.5/tools/eosio-abidiff"}},{"fields":{"slug":"/v1.5/tools/eosio-ld"}},{"fields":{"slug":"/v1.6/guides/first-smart-contract"}},{"fields":{"slug":"/v1.6/guides/cmake"}},{"fields":{"slug":"/v1.5/tools/eosio-cpp"}},{"fields":{"slug":"/v1.6/guides/native-tester"}},{"fields":{"slug":"/v1.6/guides/generator-attributes"}},{"fields":{"slug":"/v1.6/upgrading/1.2-to-1.3"}},{"fields":{"slug":"/v1.6/upgrading/1.5-to-1.6"}},{"fields":{"slug":"/v1.5/upgrading/1.5-to-1.6"}},{"fields":{"slug":"/v1.6/tools/eosio-abigen"}},{"fields":{"slug":"/v1.6/tools/eosio-cpp"}},{"fields":{"slug":"/v1.5/upgrading/1.2-to-1.3"}},{"fields":{"slug":"/v1.6/tools/eosio-abidiff"}},{"fields":{"slug":"/v1.6/tools/eosio-ld"}},{"fields":{"slug":"/v1.6/tools/eosio-init"}},{"fields":{"slug":"/v2.0/upgrading/1.2-to-1.3"}},{"fields":{"slug":"/v2.0/guides/cmake"}},{"fields":{"slug":"/v2.0/guides/first-smart-contract"}},{"fields":{"slug":"/v2.0/tools/eosio-abigen"}},{"fields":{"slug":"/v2.0/guides/generator-attributes"}},{"fields":{"slug":"/v2.0/tools/eosio-abidiff"}},{"fields":{"slug":"/v2.0/upgrading/1.5-to-1.6"}},{"fields":{"slug":"/v2.0/guides/native-tester"}},{"fields":{"slug":"/v2.0/tools/eosio-init"}},{"fields":{"slug":"/v20.0/tools/eosio-abigen"}},{"fields":{"slug":"/v20.0/tools/eosio-abidiff"}},{"fields":{"slug":"/v2.0/tools/eosio-cpp"}},{"fields":{"slug":"/v2.0/tools/eosio-ld"}},{"fields":{"slug":"/v20.0/tools/eosio-init"}},{"fields":{"slug":"/v20.0/tools/eosio-ld"}},{"fields":{"slug":"/v20.0/tools/eosio-cpp"}},{"fields":{"slug":"/v20.0/upgrading/1.5-to-1.6"}},{"fields":{"slug":"/v20.1/upgrading/1.5-to-1.6"}},{"fields":{"slug":"/v20.0/guides/first-smart-contract"}},{"fields":{"slug":"/v20.1/upgrading/1.2-to-1.3"}},{"fields":{"slug":"/v20.1/guides/first-smart-contract"}},{"fields":{"slug":"/v20.0/guides/generator-attributes"}},{"fields":{"slug":"/v20.0/guides/cmake"}},{"fields":{"slug":"/v20.1/tools/eosio-abidiff"}},{"fields":{"slug":"/v20.1/guides/generator-attributes"}},{"fields":{"slug":"/v20.0/upgrading/1.2-to-1.3"}},{"fields":{"slug":"/v20.1/guides/cmake"}},{"fields":{"slug":"/v20.1/guides/native-tester"}},{"fields":{"slug":"/v20.1/tools/eosio-abigen"}},{"fields":{"slug":"/v20.1/tools/eosio-init"}},{"fields":{"slug":"/v20.0/guides/native-tester"}},{"fields":{"slug":"/v20.1/tools/eosio-cpp"}},{"fields":{"slug":"/v20.1/tools/eosio-ld"}},{"fields":{"slug":"/v21.0/guides/first-smart-contract"}},{"fields":{"slug":"/v21.0/tools/eosio-abidiff"}},{"fields":{"slug":"/v21.0/guides/cmake"}},{"fields":{"slug":"/v21.0/guides/generator-attributes"}},{"fields":{"slug":"/v21.0/tools/eosio-abigen"}},{"fields":{"slug":"/v21.0/tools/eosio-cpp"}},{"fields":{"slug":"/v21.0/guides/native-tester"}},{"fields":{"slug":"/v21.0/tools/eosio-ld"}},{"fields":{"slug":"/v21.0/upgrading/1.5-to-1.6"}},{"fields":{"slug":"/v21.0/upgrading/1.2-to-1.3"}},{"fields":{"slug":"/v21.0/tools/eosio-init"}}]},"markdownRemark":{"html":"<h2 id=\"native-testercompilation\">Native Tester/Compilation</h2>\n<p>As of v1.5.0 native compilation can be performed and a new set of libraries to facilitate native testing and native \"scratch pad\" compilation.  <code class=\"language-text\">eosio-cc\\cpp</code> and <code class=\"language-text\">eosio-ld</code> now support building \"smart contracts\" and unit tests natively for quick tests to help facilitate faster development (note the default implementations of eosio <code class=\"language-text\">intrinsics</code> are currently asserts that state they are unavailable, these are user definable.)</p>\n<h4 id=\"getting-started\">Getting Started</h4>\n<p>Once you have your smart contract written then a test source file can be written.</p>\n<p><code class=\"language-text\">hello.hpp</code></p>\n<div class=\"gatsby-highlight\" data-language=\"c++\"><pre class=\"language-c++\"><code class=\"language-c++\">#include &lt;eosio/eosio.hpp&gt;\n\nusing namespace eosio;\n\nCONTRACT hello : public eosio::contract {\n  public:\n      using contract::contract;\n\n      ACTION hi( name user );\n\n      // accessor for external contracts to easily send inline actions to your contract\n      using hi_action = action_wrapper&lt;&quot;hi&quot;_n, &amp;hello::hi&gt;;\n};</code></pre></div>\n<p>and then a quick test\n<code class=\"language-text\">hello_test.cpp</code></p>\n<div class=\"gatsby-highlight\" data-language=\"c++\"><pre class=\"language-c++\"><code class=\"language-c++\">#include &lt;eosio/eosio.hpp&gt;\n#include &lt;eosio/tester.hpp&gt;\n\n#include &lt;hello.hpp&gt;\n\nusing namespace eosio;\nusing namespace eosio::native;\n\nEOSIO_TEST_BEGIN(hello_test)\n   // These can be redefined by the user to suit there needs per unit test\n   // the idea is that in a future release we will have a base library that \n   // initializes these to &quot;useable&quot; default implementations and probably \n   // helpers to more easily define read_action_data and action_data_size intrinsics\n   // like these&quot;\n   intrinsics::set_intrinsic&lt;intrinsics::read_action_data&gt;(\n         [](void* m, uint32_t len) {\n            check(len &lt;= sizeof(eosio::name), &quot;failed from read_action_data&quot;);\n            *((eosio::name*)m) = &quot;hello&quot;_n;\n            return len; \n         });\n\n   intrinsics::set_intrinsic&lt;intrinsics::action_data_size&gt;(\n         []() {\n            return (uint32_t)sizeof(eosio::name);\n         });\n   \n   intrinsics::set_intrinsic&lt;intrinsics::require_auth&gt;(\n         [](capi_name nm) {\n         });\n\n   \n   // &quot;Name : hello&quot; should be in the print buffer\n   CHECK_PRINT(&quot;Name : hello&quot;,\n         []() {\n            apply(&quot;test&quot;_n.value, &quot;test&quot;_n.value, &quot;hi&quot;_n.value);\n            });\n           \n   // should not assert\n   apply(&quot;test&quot;_n.value, &quot;test&quot;_n.value, &quot;check&quot;_n.value);\n   \n   name nm = &quot;null&quot;_n;\n   intrinsics::set_intrinsic&lt;intrinsics::read_action_data&gt;(\n         [&amp;](void* m, uint32_t len) {\n            check(len &lt;= sizeof(eosio::name), &quot;failed from read_action_data&quot;);\n            *((eosio::name*)m) = nm;\n            return len; \n         });\n\n   REQUIRE_ASSERT( &quot;check name not equal to `hello`&quot;,\n         []() {\n            // should assert\n            apply(&quot;test&quot;_n.value, &quot;test&quot;_n.value, &quot;check&quot;_n.value);\n            });\n\nEOSIO_TEST_END\n\n// boilerplate main, this will be generated in a future release\nint main(int argc, char** argv) {\n   silence_output(true);\n   EOSIO_TEST(hello_test);\n   return has_failed();\n}</code></pre></div>\n<p>Every <code class=\"language-text\">intrinsic</code> that is defined for eosio (prints, require_auth, etc.) is redefinable given the <code class=\"language-text\">intrinsics::set_intrinsics&lt;intrinsics::the_intrinsic_name&gt;()</code> functions.  These take a lambda whose arguments and return type should match that of the intrinsic you are trying to define.  This gives the contract writer the flexibility to modify behavior to suit the unit test being written. A sister function <code class=\"language-text\">intrinsics::get_intrinsics&lt;intrinsics::the_intrinsic_name&gt;()</code> will return the function object that currently defines the behavior for said intrinsic.  This pattern can be used to mock functionality and allow for easier testing of smart contracts.  For more information please see, either the <code class=\"language-text\">./tests</code> directory or <code class=\"language-text\">./examples/hello/tests/hello_test.cpp</code> for working examples.</p>\n<h3 id=\"compiling-native-code\">Compiling Native Code</h3>\n<ul>\n<li>Raw <code class=\"language-text\">eosio-cpp</code> to compile the test or program the only addition needed to the command line is to add the flag <code class=\"language-text\">-fnative</code> this will then generate native code instead of <code class=\"language-text\">wasm</code> code.</li>\n<li>\n<p>Via CMake</p>\n<ul>\n<li><code class=\"language-text\">add_native_library</code> and <code class=\"language-text\">add_native_executable</code> CMake macros have been added (these are a drop in replacement for add_library and add_executable).</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"eosiocdt-native-tester-api\">Eosio.CDT Native Tester API</h3>\n<ul>\n<li>\n<p>CHECK_ASSERT(...) : This macro will check whether a particular assert has occured and flag the tests as failed but allow the rest of the tests to run.  </p>\n<ul>\n<li>\n<p>This is called either by </p>\n<ul>\n<li><code class=\"language-text\">CHECK_ASSERT(&quot;&lt;assert message&gt;&quot;, [](&lt;args&gt;){ whatever_function(&lt;args&gt;); })</code></li>\n<li><code class=\"language-text\">CHECK_ASSERT([](std::string msg){ user defined comparison function }, [](&lt;args&gt;){ whatever_function(&lt;args&gt;); })</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>CHECK_PRINT(...) : This macro will check whether the print buffer holds the string that is expected and flag the tests as failed but allow the rest of the test to run.</p>\n<ul>\n<li>\n<p>This is called either by </p>\n<ul>\n<li><code class=\"language-text\">CHECK_PRINT(&quot;&lt;print message&gt;&quot;, [](&lt;args&gt;){ whatever_function(&lt;args&gt;); })</code></li>\n<li><code class=\"language-text\">CHECK_PRINT([](std::string print_buffer){ user defined comparison function }, [](&lt;args&gt;){ whatever_function(&lt;args&gt;); })</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>CHECK_EQUAL(X, Y) : This macro will check whether two inputs equal eachother and fail the test but allow the rest of the test to continue.</li>\n<li>\n<p>REQUIRE_ASSERT(...) : This macro will check whether a particular assert has occured and flag the tests as failed and halt the test on failure.  </p>\n<ul>\n<li>\n<p>This is called either by </p>\n<ul>\n<li><code class=\"language-text\">REQUIRE_ASSERT(&quot;&lt;assert message&gt;&quot;, [](&lt;args&gt;){ whatever_function(&lt;args&gt;); })</code></li>\n<li><code class=\"language-text\">REQUIRE_ASSERT([](std::string msg){ user defined comparison function }, [](&lt;args&gt;){ whatever_function(&lt;args&gt;); })</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>REQUIRE_PRINT(...) : This macro will check whether the print buffer holds the string that is expected and flag the tests as failed and halt the test on failure.</p>\n<ul>\n<li>\n<p>This is called either by </p>\n<ul>\n<li><code class=\"language-text\">REQUIRE_PRINT(&quot;&lt;print message&gt;&quot;, [](&lt;args&gt;){ whatever_function(&lt;args&gt;); })</code></li>\n<li><code class=\"language-text\">REQUIRE_PRINT([](std::string print_buffer){ user defined comparison function }, [](&lt;args&gt;){ whatever_function(&lt;args&gt;); })</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>REQUIRE_EQUAL(X, Y) : This macro will check whether two inputs <code class=\"language-text\">X</code> and <code class=\"language-text\">Y</code> equal eachother and fail the test and halt the test on failure.</li>\n<li>EOSIO_TEST_BEGIN(X) : This macro defines the beginning of a unit test and assigns <code class=\"language-text\">X</code> as the symbolic name of that test.</li>\n<li>EOSIO_TEST_END : This macro defines the end of a unit test.</li>\n<li>EOSIO_TEST(X) : This is used to run a particular named unit test <code class=\"language-text\">X</code> in the main function.</li>\n</ul>","tableOfContents":"<ul>\n<li>\n<p><a href=\"/auto-eosio-cdt/v21.0/guides/native-tester/#native-testercompilation\">Native Tester/Compilation</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/auto-eosio-cdt/v21.0/guides/native-tester/#getting-started\">Getting Started</a></li>\n</ul>\n</li>\n<li><a href=\"/auto-eosio-cdt/v21.0/guides/native-tester/#compiling-native-code\">Compiling Native Code</a></li>\n<li><a href=\"/auto-eosio-cdt/v21.0/guides/native-tester/#eosiocdt-native-tester-api\">Eosio.CDT Native Tester API</a></li>\n</ul>\n</li>\n</ul>","frontmatter":{"edit_link":null,"request_changes_link":null},"fields":{"articleTitle":"guidesnative-tester","contentTitle":"Native tester","headTagTitle":"guidesnative-tester","internalSummary":"/usr/local/lib/python3.6/dist-packages/thorka-0.1-py3.6.egg/src/lib/gatsby/data/v21.0/SUMMARY.json","isCollection":false,"isRoot":true,"isTagged":true,"organization":"EOSIO","originalKey":"/","pathData":"{\"tagged\":true,\"parentPath\":\"v21.0/guides\",\"collectionPath\":\"/\",\"rootDirPath\":\"v21.0\",\"filename\":\"native-tester.md\"}","repository":"auto-eosio-cdt","showSearch":true,"slug":"/v21.0/guides/native-tester","tagsList":"[{\"beta\":1,\"build\":0,\"deprecated\":false,\"latest\":false,\"rc\":0,\"tag\":\"v21.0.1-beta1\",\"tag_reduced\":\"21.0\",\"tag_reduced_friendly\":\"v21.0\",\"tag_sanitized\":\"21.0.1-beta1\",\"summaryPath\":\"/usr/local/lib/python3.6/dist-packages/thorka-0.1-py3.6.egg/src/lib/gatsby/data/v21.0/SUMMARY.json\",\"importedSummary\":\"N/A\",\"version\":\"v21.0\"},{\"beta\":null,\"build\":0,\"deprecated\":false,\"latest\":false,\"rc\":0,\"tag\":\"20.1.0-beta\",\"tag_reduced\":\"20.1\",\"tag_reduced_friendly\":\"v20.1\",\"tag_sanitized\":\"20.1.0-beta\",\"summaryPath\":\"/usr/local/lib/python3.6/dist-packages/thorka-0.1-py3.6.egg/src/lib/gatsby/data/v20.1/SUMMARY.json\",\"importedSummary\":\"N/A\",\"version\":\"v20.1\"},{\"beta\":0,\"build\":0,\"deprecated\":false,\"latest\":true,\"rc\":0,\"tag\":\"20.0.6\",\"tag_reduced\":\"20.0\",\"tag_reduced_friendly\":\"v20.0\",\"tag_sanitized\":\"20.0.6\",\"summaryPath\":\"/usr/local/lib/python3.6/dist-packages/thorka-0.1-py3.6.egg/src/lib/gatsby/data/latest/SUMMARY.json\",\"importedSummary\":\"N/A\",\"version\":\"latest\"},{\"beta\":0,\"build\":0,\"deprecated\":false,\"latest\":false,\"rc\":0,\"tag\":\"v20.0.5\",\"tag_reduced\":\"20.0\",\"tag_reduced_friendly\":\"v20.0\",\"tag_sanitized\":\"20.0.5\",\"summaryPath\":\"/usr/local/lib/python3.6/dist-packages/thorka-0.1-py3.6.egg/src/lib/gatsby/data/v20.0/SUMMARY.json\",\"importedSummary\":\"N/A\",\"version\":\"v20.0\"},{\"beta\":9,\"build\":0,\"deprecated\":false,\"latest\":false,\"rc\":0,\"tag\":\"v2.0.0-beta9\",\"tag_reduced\":\"2.0\",\"tag_reduced_friendly\":\"v2.0\",\"tag_sanitized\":\"2.0.0-beta9\",\"summaryPath\":\"/usr/local/lib/python3.6/dist-packages/thorka-0.1-py3.6.egg/src/lib/gatsby/data/v2.0/SUMMARY.json\",\"importedSummary\":\"N/A\",\"version\":\"v2.0\"},{\"beta\":0,\"build\":0,\"deprecated\":false,\"latest\":false,\"rc\":0,\"tag\":\"v1.6.21\",\"tag_reduced\":\"1.6\",\"tag_reduced_friendly\":\"v1.6\",\"tag_sanitized\":\"1.6.21\",\"summaryPath\":\"/usr/local/lib/python3.6/dist-packages/thorka-0.1-py3.6.egg/src/lib/gatsby/data/v1.6/SUMMARY.json\",\"importedSummary\":\"N/A\",\"version\":\"v1.6\"},{\"beta\":0,\"build\":0,\"deprecated\":false,\"latest\":false,\"rc\":0,\"tag\":\"v1.5.0\",\"tag_reduced\":\"1.5\",\"tag_reduced_friendly\":\"v1.5\",\"tag_sanitized\":\"1.5.0\",\"summaryPath\":\"/usr/local/lib/python3.6/dist-packages/thorka-0.1-py3.6.egg/src/lib/gatsby/data/v1.5/SUMMARY.json\",\"importedSummary\":\"N/A\",\"version\":\"v1.5\"},{\"beta\":0,\"build\":0,\"deprecated\":false,\"latest\":false,\"rc\":0,\"tag\":\"v1.4.1\",\"tag_reduced\":\"1.4\",\"tag_reduced_friendly\":\"v1.4\",\"tag_sanitized\":\"1.4.1\",\"summaryPath\":\"/usr/local/lib/python3.6/dist-packages/thorka-0.1-py3.6.egg/src/lib/gatsby/data/v1.4/SUMMARY.json\",\"importedSummary\":\"N/A\",\"version\":\"v1.4\"}]","latestDDVersion":"latest","importedSummary":"N/A","hasPrimaryNavigation":false,"primaryNavData":"[{\"text\":\"NONE\",\"path\":\"EMPTY\"}]","currentVersion":"v21.0","currentDDVersion":"21.0","summaryJson":"{\"array\":[{\"sub\":[{\"title\":\"Cmake\",\"link\":\"guides/cmake.md\"},{\"title\":\"First smart contract\",\"link\":\"guides/first-smart-contract.md\"},{\"title\":\"Generator attributes\",\"link\":\"guides/generator-attributes.md\"},{\"title\":\"Native tester\",\"link\":\"guides/native-tester.md\"}],\"title\":\"Guides\"},{\"sub\":[{\"title\":\"Eosio abidiff\",\"link\":\"tools/eosio-abidiff.md\"},{\"title\":\"Eosio abigen\",\"link\":\"tools/eosio-abigen.md\"},{\"title\":\"Eosio cpp\",\"link\":\"tools/eosio-cpp.md\"},{\"title\":\"Eosio init\",\"link\":\"tools/eosio-init.md\"},{\"title\":\"Eosio ld\",\"link\":\"tools/eosio-ld.md\"}],\"title\":\"Tools\"},{\"sub\":[{\"title\":\"1.2 to 1.3\",\"link\":\"upgrading/1.2-to-1.3.md\"},{\"title\":\"1.5 to 1.6\",\"link\":\"upgrading/1.5-to-1.6.md\"}],\"title\":\"Upgrading\"}],\"title\":[]}"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/v21.0/guides/native-tester"}}}